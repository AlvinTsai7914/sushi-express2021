<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link rel="icon" type="image/png" sizes="16x16" href="img/scene_5_sushi.svg" />
        <link rel="stylesheet" href="css/style.css" />
        <link rel="stylesheet" href="/fontawesome/css/all.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />
        <title>版型</title>
    </head>
    <body>
        <!-- warpper 開始 -->
        <div class="wrapper">
            <!-- container 開始 -->
            <div class="container">
                        <!-- 第二幕 遊戲 -->
                        <div class="game_scene">
                            <div class="chat_bubble_box">   
                                <!-- 對話框1 -->
                                <div class="chat_bubble game_first">
                                    <p class="chat">台灣鯛魚哥在哪裡啊? 
                                        <span>請點擊捕捉</span></p>
                                </div>
        
                                <!-- 對話框2 -->
                                <div class="chat_bubble game_second d-none">
                                    <p class="chat">哎呀~臺灣鯛魚哥逃走了！
                                        <span>請再次點擊捕捉</span></p>
                                </div>
        
                                <!-- 對話框3 -->
                                <div class="chat_bubble game_third d-none">
                                    <p class="chat">再次點擊臺灣鯛魚哥
                                        進行收網捕捉</p>
                                </div>
        
                                <!-- 對話框 點到蝦或飛魚 -->
                                <div class="chat_bubble game_fail d-none">
                                    <p class="chat">這不是臺灣鯛魚哥唷！</p>
                                </div>
        
                                <!-- 對話框 點到蝦或飛魚 -->
                                <div class="chat_bubble egg1 d-none">
                                    <p class="chat">其實你有看到鯛魚哥的
                                        ..............對吧?</p>
                                </div>
        
                                <!-- 對話框 點到蝦或飛魚 -->
                                <div class="chat_bubble egg2 d-none">
                                    <p class="chat">再這樣我要生氣摟</p>
                                </div>
        
                                <!-- 對話框 點到蝦或飛魚 -->
                                <div class="chat_bubble egg d-none">
                                    <p class="chat">好吧好吧...算我輸
                                        鯛魚哥在這...</p>
                                </div>
                            </div>
                            <div class="river">
                                <!-- 第四層海浪 -->
                                <div class="wave_box z-10">
                                    <img src="img/scene_2_wave_4.svg" alt="" class="wave" />
                                </div>
                                <!-- 第三層海浪 -->
                                <div class="wave_box z-20">
                                    <div class="float_up3">
                                        <img class="diu" src="img/scene_2_fish_3.svg" />
                                    </div>
                                    <div class="float_up5">
                                        <div class="shadow">
                                            <img class="diu prize" src="img/scene_2_fish_light.svg" />
                                        </div>
                                        <div class="light"></div>
                                    </div>
                                    <img src="img/scene_2_wave_3.svg" alt="" class="wave" />
                                </div>
                                <!-- 第二層海浪 -->
                                <div class="wave_box z-30">
                                    <div class="float_up1">
                                        <img class="fish" src="img/scene_2_fish_1.svg" />
                                    </div>
        
                                    <img src="img/scene_2_wave_2.svg" alt="" class="wave" />
                                </div>
                                <!-- 第一層海浪 -->
                                <div class="wave_box z-40">
                                    <div class="float_up2">
                                        <img class="shrink" src="img/scene_2_fish_2.svg" />
                                    </div>
                                    <div class="float_up4">
                                        <img class="diu" src="img/scene_2_fish_3.svg" />
                                    </div>
                                    <img src="img/scene_2_wave_1.svg" alt="" class="wave" />
                                </div>
                                <!-- 預防破圖的海浪 -->
                                <div class="wave_box z-40" style="pointer-events: none
                                ;">
                                    <img src="img/scene_2_wave_4.svg" alt="" class="wave" />
                                </div>
                            </div>
                        </div>

            </div>
        </div>
        <!-- warpper 結束 -->

        <audio data-name="click" src="audio/click.mp3" alt=""></audio>
        <audio data-name="mission" src="audio/misson.mp3" alt=""></audio>
        <audio data-name="fish_jump" src="audio/fish_jump.mp3" alt=""></audio>
        <audio data-name="prize" src="audio/prize.mp3" alt=""></audio>
        <audio data-name="BGM-suspense" src="audio/BGM-suspense.mp3" alt=""></audio>
        <audio data-name="BGM-speed" src="audio/BGM-speed.mp3" alt=""></audio>
        <audio data-name="BGM-happy" src="audio/BGM-happy.mp3" alt=""></audio>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
        <script src="js/common.js"></script>
        <script>
            $(function () {
                let n = 4;
                let failure_count = 1;

                function failure(etc) {
                    console.log("failure_count:" + failure_count);
                    if (failure_count < 10) {
                        $(`.${etc}`).addClass("wrong");
                        dNone(".chat_bubble");
                        dShow(".chat_bubble.game_fail");
                        setTimeout(() => {
                            $(`.${etc}`).removeClass("wrong");
                        }, 1000);
                    } else if (failure_count >= 10 && failure_count < 20) {
                        $(`.${etc}`).addClass("wrong");
                        dNone(".chat_bubble");
                        dShow(".egg1");
                        setTimeout(() => {
                            $(`.${etc}`).removeClass("wrong");
                        }, 1000);
                    } else if (failure_count >= 20 && failure_count < 30) {
                        $(`.${etc}`).addClass("wrong");
                        dNone(".chat_bubble");
                        dShow(".egg2");

                        setTimeout(() => {
                            $(`.${etc}`).removeClass("wrong");
                        }, 1000);
                    } else if (failure_count >= 30) {
                        $(".float_up" + (n - 1)).addClass("active");
                        $(".shrink").addClass("active");
                        $(".fish").addClass("active");
                        $(".float_up5").show();
                        dNone(".chat_bubble");
                        dShow(".egg");
                    }
                }

                // 進入遊戲後五秒才能點擊鯛
                setTimeout(() => {
                    console.log("pointer-events:auto");
                    $(".diu").css({ "pointer-events": "auto" });
                }, 8000);

                $(".game_scene").click(function (e) {
                    let etc = e.target.className;

                    if (etc === "diu") {
                        $(e.target).parent().addClass("active");
                        $(".diu").css({ "pointer-events": "none" });
                        // 被點擊的消失 下一個出來
                        setTimeout(function () {
                            console.log("pointer-events none");
                            $(e.target).parent().hide();
                            $(".float_up" + n).show();
                            n++;
                        }, 800);

                        setTimeout(function () {
                            console.log("pointer-events auto");
                            $(".diu").css({ "pointer-events": "auto" });
                        }, 3000);

                        if (n === 4) {
                            dNone(".chat_bubble");
                            dShow(".game_second");
                        }

                        if (n === 5) {
                            $(".shrink").addClass("active");
                            $(".fish").addClass("active");
                            dNone(".chat_bubble");
                            dShow(".game_third");
                        }
                    }

                    if (etc === "diu prize") {
                        $(".float_up5").addClass("active");
                        $(".game_scene").addClass("active");
                        setTimeout(function () {
                            $(".game_scene").hide();
                        }, 6000);
                    }

                    if (etc === "shrink" || etc === "fish") {
                        failure(etc);
                        failure_count++;
                    }
                });
            });
        </script>
    </body>
</html>
